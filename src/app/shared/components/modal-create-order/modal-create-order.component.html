<ion-header>
  <ion-toolbar>
      <ion-buttons>
        <ion-button (click)="dismiss()">
          <ion-icon name="arrow-back-outline"></ion-icon>
        </ion-button>
        <ion-title class="ion-text-center">Contratar Paseador / Cuidador</ion-title>
        <img src="../../../../assets/logo.png" width="70" height="60" slot="end">
      </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-card>
    <ion-card-content>
      <form #formulario="ngForm" (ngSubmit)="createOrder()">
        <ion-item>
          <ion-radio-group name="orderType" required [(ngModel)]="newOrder.orderType">
            <ion-card-header>
              <ion-label>Tipo de servicio</ion-label>
            </ion-card-header>
            
            <div *ngIf="this.caretaker.petCareData?.type === 'Cuidador'; else PaseadorTemplate">
              <div *ngFor="let orderType of orderTypes"> 
                <ion-item>
                  <ion-label>{{orderType}}</ion-label>
                  <ion-radio disabled name={{orderType}} value={{orderType}} slot="start"></ion-radio>
                </ion-item>
              </div>
            </div>

            <ng-template #PaseadorTemplate>
              <div *ngIf="this.caretaker.petCareData?.type === 'Paseador'; else bothBlock">
                <div *ngFor="let orderType of orderTypes">
                  <ion-item>
                    <ion-label>{{orderType}}</ion-label>
                    <ion-radio disabled name={{orderType}} value={{orderType}} slot="start"></ion-radio>
                  </ion-item>
                </div>
              </div>
            </ng-template>
            
            <ng-template #bothBlock>
              <div *ngFor="let orderType of orderTypes">
                <ion-item>
                  <ion-label>{{orderType}}</ion-label>
                  <ion-radio name={{orderType}} value={{orderType}} slot="start"></ion-radio>
                </ion-item>
              </div>
            </ng-template>
          </ion-radio-group>
        </ion-item>

        <ion-item>
          <ion-radio-group name="petSelection" required [(ngModel)]="newOrder.pet">
            <ion-card-header>
              <ion-label>Seleccione la mascota a pasear</ion-label>
            </ion-card-header>
            <div *ngFor="let pet of pets">
              <ion-item>
                <ion-label>{{pet.name}}</ion-label>
                <ion-radio slot="start" value={{pet}}></ion-radio>
              </ion-item>
            </div>
          </ion-radio-group>
        </ion-item>

        <div *ngIf="newOrder.orderType === 'Cuidado'">
            <ion-card-header>
              Selecciona el dia del cuidado
            </ion-card-header>
            
            <ion-radio-group name="day" [(ngModel)]="newOrder.day">
              <ion-item *ngFor="let day of days">
                <ion-label>{{day}}</ion-label>
                <ion-radio value={{day}} name={{day}}></ion-radio>
              </ion-item>
            </ion-radio-group>
            
            <ion-item>
              <ion-textarea name="description" [(ngModel)]="newOrder.description" rows="6" cols="20" placeholder="Escriba cualquier detalle que quiera agregar"></ion-textarea>
            </ion-item>
        </div>
        
        <div *ngIf="newOrder.orderType === 'Paseo'">
          <ion-item>
            <ion-label>Seleccione una ruta</ion-label>
            <ion-select (ionChange)="onChangeRoute(selectedRoute)" interface="popover" name="walkPath" required [(ngModel)]="selectedRoute">
              <div *ngFor="let route of routes">
                <ion-select-option [value]="route.data">{{route.data.location}}</ion-select-option>
              </div>
            </ion-select>
          </ion-item>

          <ion-item>
            <ion-radio-group name="shared" required [(ngModel)]="newOrder.shared">
              <ion-card-header>
                <ion-label>Servicio compartido</ion-label>
              </ion-card-header>
                <ion-item>
                  <ion-label>Si</ion-label>
                  <ion-radio name="yes" value={{true}} slot="start"></ion-radio>
                </ion-item>
                <ion-item>
                  <ion-label>No</ion-label>
                  <ion-radio name="no" value={{false}} slot="start"></ion-radio>
                </ion-item>
            </ion-radio-group>
          </ion-item>

          <ion-item>
            <ion-label>Dia de servicio</ion-label>
            <ion-datetime name="dayService" display-format="DD-MM" picker-format="DD-MM" [required]="true" [(ngModel)]="newOrder.dayService"></ion-datetime>
          </ion-item>

          <br>
        </div>
        <ion-button type="submit" expand="full" [disabled]="formulario.invalid">
          Enviar orden <ion-icon name="checkmark-outline" style="text-align: center"></ion-icon>
        </ion-button>
      </form>
    </ion-card-content>
  </ion-card>
</ion-content>